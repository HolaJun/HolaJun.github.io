<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<link rel="stylesheet" href="/assets/css/atom-one-light.css">
    
        <title>Test.markup</title>
		<link rel="stylesheet" type="text/css" href="/assets/css/002.css">
    
	<link rel="stylesheet" href="/assets/css/font-awesome.min.css">
	<link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
	<script src="/assets/js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
	<div class="wrapper">

		<!-- Title -->
		<div class="default_title">
			<img src="/assets/img/mycomputer.png" />
			
				<h1>HolaJun</h1>
			
		</div>

		<!-- Menubar -->
		<ul class="topbar">
	<a href="/" target="_self"><li><u>H</u>ome</li></a>
	<a href="http://github.com/holajun" target="_blank"><li><u>G</u>ithub</li></a>
	<a href="/me"><li><u>K</u>akao</li></a>
	<a href="/me"><li><u>A</u>boutMe</li></a>
</ul>


		<!-- Tag_List -->
		<div class="tag_list">
			<ul id="tag-list">
				<li><a href="/" ><img src="/assets/img/disk.png" />(C:)</a>
			<ul>
				
				
				<li>
					<a href="/tag/test/" title="test">
						<img src="/assets/img/folder.ico" />
						<!-- 태그이름 -->
						test
					</a>
				</li>
				
				<li>
					<a href="/tag/기본/" title="기본">
						<img src="/assets/img/folder.ico" />
						<!-- 태그이름 -->
						기본
					</a>
				</li>
				
			</ul>
				</li>
			</ul>
		</div>

		<!-- Post_List -->
		<div class="post_list">
			
				<ul>
					
					<li><a href="/2018-09-07/Test.MARKUP" title="Test.markup"><img src="/assets/img/file.ico" title="Test.markup" />Test.markup</a></li>
					
					<li><a href="/2018-08-23/%EA%B8%B0%EB%B3%B8CS%EC%A0%95%EB%A6%AC" title="기본CS정리"><img src="/assets/img/file.ico" title="기본CS정리" />기본CS정리</a></li>
					
					<li><a href="/2018-08-05/Ubuntu-nodejs-install" title="Ubuntu Nodejs설치"><img src="/assets/img/file.ico" title="Ubuntu Nodejs설치" />Ubuntu Nodejs설치</a></li>
					
				</ul>
			
		</div>
		<div class="post_total">
			
				<div class="left">3 object(s)</div>
			
			<div class="right">&nbsp;</div>
		</div>
	</div>

	<!-- 글이 클릭된 상태인 경우 -->
	
        <div class="content">
			<div class="post_title">
				<img src="/assets/img/file.png" />
				<h1>Test.markup</h1>
				<a href="/"><div class="btn"><span class="fa fa-times"></span></div></a> <!-- 최소화 -->
				<div class="btn btn_max"><span class="fa fa-window-maximize"></span></div> <!-- 최대화 -->
				<div class="btn"><span class="fa fa-window-minimize"></span></div> <!-- 종료 -->
			</div>
			<ul class="topbar">
				<li>September 7, 2018</li>
			</ul>
			<div class="post_content">
        		<h2 id="1-awsec2-ubuntu에서의-mongodb-setting">1. AWS(ec2 ubuntu)에서의 MongoDB Setting</h2>

<h4 id="11-mongodb-설치">1.1 MongoDB 설치</h4>

<ul>
  <li>sudo apt-key adv –keyserver hkp://keyserver.ubuntu.com:80 –recv  0C49F3730359A14518585931BC711F9BA15703C6</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>echo “deb <a href="http://repo.mongodb.org/apt/ubuntu">http://repo.mongodb.org/apt/ubuntu</a> “$(lsb_release -sc)”/mongodb-org/3.0 multiverse”</td>
          <td>sudo tee /etc/apt/sources.list.d/mongodb-org-3.0.list</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>sudo apt-get update</li>
  <li>sudo apt-get install -y mongodb-org</li>
</ul>

<h4 id="12-mongodb-시작-종료-재시작">1.2 MongoDB 시작, 종료, 재시작</h4>

<ul>
  <li>sudo service mongod start</li>
  <li>sudo service mongod stop</li>
  <li>sudo service mongod restart</li>
</ul>

<h4 id="13-mongodb-제거">1.3 MongoDB 제거</h4>

<ul>
  <li>sudo service mongod stop</li>
  <li>sudo apt-get purge mongodb-org*</li>
  <li>sudo rm -r /var/log/mongodb</li>
  <li>sudo rm -r /var/lib/mongodb</li>
</ul>

<h4 id="14-mongodb-root계정-생성">1.4 MongoDB ROOT계정 생성</h4>

<ul>
  <li>use admin</li>
  <li>db.createUser( 
                              { user: “ROOT_ID”, 
                                pwd: “ROOT_PWD”, 
                                roles: [“root”] 
                                } 
                             )</li>
  <li>db.createUser(
                              { user: “USER_NAME”,
                                 pwd: “PASSWORD”,
                                 roles: [“userAdminAnyDatabase”,
                                             “dbAdminAnyDatabase”,
                                             “dbAdminAnyDatabase”
                                            ]
                                }
                             )</li>
</ul>

<h4 id="15-mongodb-일반-사용자-계정-생성">1.5 MongoDB 일반 사용자 계정 생성</h4>

<ul>
  <li>
    <p>use 데이터베이스명</p>
  </li>
  <li>
    <p>db.createUser(</p>

    <p>​                          { user: “USER_NAME”,</p>

    <p>​			     pwd: “PASSWORD”,</p>

    <p>​			     roles: [ “dbAdmin”,</p>

    <p>​					 “readWrite” ]</p>

    <p>​			   }</p>

    <p>​			  )</p>
  </li>
</ul>

<h4 id="16-관리자사용자-계정-삭제">1.6 관리자&amp;사용자 계정 삭제</h4>

<ul>
  <li>
    <p>use admin 또는 use 데이터베이스명</p>
  </li>
  <li>
    <p>db.dropUser(“USER_NAME”)</p>
  </li>
</ul>

<h2 id="2-awsec-ubuntu-secure-setting">2. AWS(ec ubuntu) Secure Setting</h2>

<ol>
  <li>
    <p>AWS Management Console -&gt; EC2 -&gt; Security Groups -&gt; EC2’s Security Group -&gt; Add Custom TCP Rule, 27017, AnyWhere</p>
  </li>
  <li>
    <p>외부 접속 허용을 위해,</p>

    <p>2-1. sudo /etc/mongod.conf</p>

    <p>2-2. bindIp: 0.0.0.0 으로 변경</p>

    <p>2-3. sudo service mongod restart</p>
  </li>
  <li>
    <p>관리자 계정 생성</p>
  </li>
  <li>
    <p>sudo vi /etc/mongod.conf -&gt; security의 authorization: enabled로 변경</p>
  </li>
  <li>
    <p>sudo service mongod restart</p>
  </li>
</ol>

<h2 id="3-python3에서-aws-mongodb-데이터-가져오기">3. Python3에서 AWS MongoDB 데이터 가져오기</h2>

<pre><code>import pymongo

username = 'rootid'
password = 'rootpw'

# Connect AWS-Mongo
conn = pymongo.MongoClient('mongodb://%s:%s@13.209.66.162' % (username, password))

# Select Database
db = conn.get_database('admin')

# Select Collection
collection = db.get_collection('testcoll')

docs = collection.find() # find()에 인자가 없으면 해당 컬렉션의 전체 데이터 조회. return type = cursor
print('전체 조회')
for result in docs:
    print(result)

docs = collection.find(
                        { "name" : "su" }
                      )
print("name이 su인 document")
for result in docs:
    print(result)
</code></pre>

<ul>
  <li>environment: Pycharm 2018.1.14(Community), Pymongo, AWS ec2 Ubuntu</li>
</ul>

<h2 id="4-java에서-aws-mongodb-데이터-가져오기">4. JAVA에서 AWS MongoDB 데이터 가져오기</h2>

<pre><code>package mongoConnTest;

import org.bson.Document;

import com.mongodb.MongoClient;
import com.mongodb.MongoClientURI;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoDatabase;

public class mongoConn {
	public static void main(String args[]) {
		try {		
			MongoClient mongoClient = new MongoClient(
					  new MongoClientURI("mongodb://rootid:rootpw@13.209.66.162/admin")
					  // mongodb://ID:PASSWORD@IP/DATABASE
					);
			MongoDatabase db = mongoClient.getDatabase("admin");
//			Document course = new Document();
			FindIterable&lt;Document&gt; docs = db.getCollection("testcoll").find();
			for(Document d: docs){
				System.out.println(d);
			}
		} catch(Exception e) {
			System.out.println(e);
		}
	}
}
</code></pre>
<ul>
  <li>environment: Eclipse Mars.2 Release (4.5.2), mongo-java-driver-3.8.0.jar</li>
</ul>

				
					<br>
<hr>
<br>
<div class="donate">
 donate.html
</div>

				
			</div>
		</div>
    
	<script src="/assets/js/001.js"></script>
	<script src="/assets/js/002.js"></script>
	<div class="footer">
		<p>All Copyright Holajun. This Template by <a href="http://github.com/h01000110" target="_blank">h01000110. Thank you! </a></p>
	</div>
</body>
</html>
